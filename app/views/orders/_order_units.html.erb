<!-- 板料 start -->
<tr>
  <td colspan="10"></td>
</tr>
<tr>
  <th colspan="10">
    部件信息
    <%= link_to '手动编辑', '#', data: {toggle: 'modal', target: '#addOrderUnits'}, class: 'pull-right btn-xs btn-primary' %>
  </th>
</tr>
<tr>
  <th>名称</th>
  <th>数量</th>
  <th>厚度</th>
  <th>长</th>
  <th>宽</th>
  <th>尺寸</th>
  <th>单位</th>
  <th>单价</th>
  <th>合计金额</th>
  <th>备注</th>
</tr>
<% if @materials.present? %>
<% @materials.each do |m| %>
<tr>
  <td><%= m.full_name %></td>
  <td><%= m.number %></td>
  <td><%= MaterialCategory.find_by_id(m.ply).try(:name) %></td>
  <td><%= m.length %></td>
  <td><%= m.width %></td>
  <td><%= m.size %></td>
  <td><%= m.uom %></td>
  <td><%= m.price %></td>
  <td><%= m.price * m.number %></td>
  <td><%= m.note %></td>
</tr>
<% end %>
<% else %>
<tr>
  <td colspan="10">暂无部件信息</td>
</tr>
<% end %>
<!-- 板料 end -->


<!-- Modal -->
<div class="modal fade" id="addOrderUnits" tabindex="-1" role="dialog" aria-labelledby="addOrderUnitsLabel">
  <div class="modal-dialog" role="document"  style="width:90%">
    <div class="modal-content">
    <%= nested_form_for @order, html: {class: 'form-horizontal', multipart: true} do |f| %>
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="addOrderUnitsLabel">部件 <small>编辑</small></h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <!-- <div class="panel-heading">
          </div> -->
          <div class="panel-body">
            <div id="orderUnitsForm">
              <%= f.fields_for :units, wrapper: false do |unit_form| %>
                <hr>
                <div class="fields row">
                  <div class="col-sm-2">
                    <label>名称</label>
                    <%= unit_form.text_field :name %>
                  </div>
                  <div class="col-sm-2">
                    <%= unit_form.link_to_remove '删除',class:'btn btn-info' %>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <%= f.link_to_add '添加部件', units, data: {target: '#orderUnitsForm'} %>
        <%= f.button '取消', class: 'btn btn-default', data: {dismiss: 'modal'} %>
        <%= f.submit '提交', class: 'btn btn-primary' %>
      </div>
      <% end %>
    </div>
  </div>
</div>
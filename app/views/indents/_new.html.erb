<!-- Modal -->
<div class="modal fade" id="addIndent" tabindex="-1" role="dialog" aria-labelledby="addIndentLabel">
  <div class="modal-dialog" role="document" style="width: 100%;">
    <div class="modal-content">
      <%= nested_form_for @indent, html: {class: 'form-horizontal', multipart: true} do |f| %>
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="addIndentLabel"> 订单 <small>新建</small></h4>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <%= f.label '订单编号', for: 'indent_name', class: 'col-sm-1 control-label' %>
          <div class="col-sm-3">
            <%= f.text_field :name, class: 'form-control', required: true %>
          </div>
          <%= f.label '终端客户', for: 'indent_customer', class: 'col-sm-1 control-label' %>
          <div class="col-sm-7">
            <%= f.text_field :customer, class: 'form-control', required: true %>
          </div>
        </div>
        <div class="form-group">
          <%= f.label '代理商', for: 'indent_agent_id', class: 'col-sm-1 control-label' %>
          <div class="col-sm-3">
            <%= f.select :agent_id, Agent.all.map{|a|[a.name, a.id]}, class: 'form-control' %>
          </div>
          <%= f.label '下单时间', for: 'indent_verify_at', class: 'col-sm-1 control-label' %>
          <div class="col-sm-3">
            <%= f.date_field :verify_at, class: 'form-control', data: {provide: 'datepicker'}, required: true %>
          </div>
          <%= f.label '下单时间', for: 'indent_require_at', class: 'col-sm-1 control-label' %>
          <div class="col-sm-3">
            <%= f.date_field :require_at, class: 'form-control', data: {provide: 'datepicker'}, required: true %>
          </div>
        </div>
        <hr/>
        <div class="panel panel-default">
          <div class="row">
            <div id="orders">
              <%= f.fields_for :orders, :wrapper => false do |of| %>
              <div class="fields awidget">
                <div class="col-sm-1 text-center indent-orders-title">
                  <h4>子订单</h4>
                </div>
                <div class="col-sm-10">
                  <div class="row">
                    <div class="col-sm-2">
                      <%= of.label '类型', for: 'indent_name', class: 'control-label' %>
                      <%= of.select :order_category_id, OrderCategory.all.map{|oc| [oc.name, oc.id]}, class: 'form-control', required: true %>
                    </div>
                    <div class="col-sm-2">
                      <%= of.label '厚度', for: 'indent_ply', class: 'control-label' %>
                      <%= of.select :ply, MaterialCategory.where(oftype:MaterialCategory.oftypes[:ply]).map{|mc| [mc.name, mc.id]} %>
                    </div>
                    <div class="col-sm-2">
                      <%= of.label '材质', for: 'indent_texture', class: 'control-label' %>
                      <%= of.select :texture, MaterialCategory.where(oftype:MaterialCategory.oftypes[:texture]).map{|mc| [mc.name, mc.id]} %>
                    </div>
                    <div class="col-sm-2">
                      <%= of.label '颜色', for: 'indent_color', class: 'control-label' %>
                      <%= of.select :color, MaterialCategory.where(oftype:MaterialCategory.oftypes[:color]).map{|mc| [mc.name, mc.id]} %>
                    </div>
                    <div class="col-sm-4">
                      <%= of.label '状态', for: 'indent_status', class: 'control-label' %>
                      <%= of.select :status, Order.status %>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-sm-2">
                      <%= of.label '数量', for: 'indent_number', class: 'control-label' %>
                      <%= of.number_field :number, value: 1, min: 1 %>
                    </div>
                    <div class="col-sm-2">
                      <%= of.label '长度', for: 'indent_length', class: 'control-label' %>
                      <%= of.number_field :length, value: 1, min: 1 %>
                    </div>
                    <div class="col-sm-2">
                      <%= of.label '宽度', for: 'indent_width', class: 'control-label' %>
                      <%= of.number_field :width, value: 1, min: 1 %>
                    </div>
                    <div class="col-sm-2">
                      <%= of.label '高度', for: 'indent_height', class: 'control-label' %>
                      <%= of.number_field :height, value: 1, min: 1 %>
                    </div>
                    <div class="col-sm-4">
                      <%= of.label '备注', for: 'indent_note', class: 'control-label' %>
                      <%= of.text_field :note %>
                    </div>
                  </div>
                </div>
                <div class="col-sm-1 text-center indent-orders-delete">
                  <!-- 位置不对 -->
                  <%= of.link_to_remove '删除', class: 'btn btn-info btn-lg' %>
                </div>
              </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div class="pull-left">
          <%= f.link_to_add '添加子订单', :order, data: {target: "#orders"}, class: 'btn btn-info' %>
        </div>
        <%= f.button '取消', class: 'btn btn-default', data: {dismiss: 'modal'} %>
        <%= f.submit '提交', class: 'btn btn-primary' %>
      </div>
      <% end %>
    </div>
  </div>
</div>